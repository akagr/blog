<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>How to write a JSPM package | Akash Agrawal</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="How to write a JSPM package" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Learn how to create a jspm package from scratch" />
<meta property="og:description" content="Learn how to create a jspm package from scratch" />
<link rel="canonical" href="https://akashagrawal.me/2016/01/18/how-to-write-a-jspm-package.html" />
<meta property="og:url" content="https://akashagrawal.me/2016/01/18/how-to-write-a-jspm-package.html" />
<meta property="og:site_name" content="Akash Agrawal" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2016-01-18T00:00:00-06:00" />
<script type="application/ld+json">
{"url":"https://akashagrawal.me/2016/01/18/how-to-write-a-jspm-package.html","@type":"BlogPosting","headline":"How to write a JSPM package","dateModified":"2016-01-18T00:00:00-06:00","datePublished":"2016-01-18T00:00:00-06:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://akashagrawal.me/2016/01/18/how-to-write-a-jspm-package.html"},"description":"Learn how to create a jspm package from scratch","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://akashagrawal.me/feed.xml" title="Akash Agrawal" /><link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Akash Agrawal</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">About Me</a><a class="page-link" href="/search/">Search</a><a class="page-link" href="/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">How to write a JSPM package</h1><p class="page-description">Learn how to create a jspm package from scratch</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2016-01-18T00:00:00-06:00" itemprop="datePublished">
        Jan 18, 2016
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      2 min read
    
</span></p>

    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <h2 id="why">Why</h2>

<p>So I was assigned with building payment capabilities in my project at work and we decided to go with stripe. If you haven’t heard of it, it’s an awesome and developer friendly (looking at you, paypal!) payment gate which powers many cool web apps like shopify, kickstarter etc.</p>

<p>Now before I proceed further, let me tell you a couple of things about project and stripe. This is an angularjs app using JSPM (duh!) to manage dependencies. There’s already an awesome <a href="https://github.com/bendrucker/angular-stripe">angular-stripe</a> but it doesn’t include <code class="language-plaintext highlighter-rouge">stripe.js</code>, the base code for all the front-end stuff stripe exposes to developer.</p>

<p>Now there is obviously no problem in downloading this file, placing it somewhere in project and doing:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="dl">'</span><span class="s1">lib/js/stripe</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>

<p>It’d work. But it didn’t feel right for two reasons:</p>

<ol>
  <li>I had to create that folder just for stripe. This being an angular application, all of the internal libraries were written as services and <code class="language-plaintext highlighter-rouge">stripe.js</code> wouldn’t have fit in with them too well.</li>
  <li><code class="language-plaintext highlighter-rouge">stripe.js</code> is very much an external dependency and should go with other external dependencies in <code class="language-plaintext highlighter-rouge">package.json</code>.</li>
</ol>

<p>In case you’ve not already guessed it, I decided to create a jspm package for stripe.js and import that into project through cli like any other dependency. I was surprised to see how little there is on the web to tell me how to do this. This post is aimed to remedy some of that.</p>

<h2 id="how">How</h2>

<p>I created a directory for this package (outside of project obviously) and initialised JSPM in it.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir</span> <span class="nt">-p</span> stripe-jspm/lib <span class="o">&amp;&amp;</span> <span class="nb">cd </span>stripe-jspm
jspm init <span class="nt">-y</span>
</code></pre></div></div>

<p>That gave me a <code class="language-plaintext highlighter-rouge">package.json</code>, <code class="language-plaintext highlighter-rouge">config.js</code> and an empty <code class="language-plaintext highlighter-rouge">lib</code> directory.</p>

<p>Next, I downloaded the <code class="language-plaintext highlighter-rouge">stripe.js</code> and placed it in <code class="language-plaintext highlighter-rouge">lib</code>.</p>

<p>Since stripe requires jQuery, I added it as dependency for our <code class="language-plaintext highlighter-rouge">stripe-jspm</code> package.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jspm <span class="nb">install </span>jquery
</code></pre></div></div>

<p>Finally, I needed to specify a <code class="language-plaintext highlighter-rouge">main</code> file in <code class="language-plaintext highlighter-rouge">package.json</code> which <code class="language-plaintext highlighter-rouge">system.js</code> uses to expose the module exported by the package. So I created an <code class="language-plaintext highlighter-rouge">index.js</code> in project root and populated it with the following:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="dl">'</span><span class="s1">jquery</span><span class="dl">'</span><span class="p">;</span>
<span class="k">import</span> <span class="dl">'</span><span class="s1">./lib/stripe</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">Stripe</span><span class="p">;</span>
</code></pre></div></div>

<p>And added it in package.json:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="p">{</span><span class="w">
     </span><span class="nl">"main"</span><span class="p">:</span><span class="w"> </span><span class="s2">"index.js"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">&lt;========</span><span class="w"> </span><span class="err">This</span><span class="w"> </span><span class="err">right</span><span class="w"> </span><span class="err">here</span><span class="w">
     </span><span class="nl">"jspm"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
         </span><span class="nl">"dependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="nl">"jquery"</span><span class="p">:</span><span class="w"> </span><span class="s2">"npm:jquery@^2.2.0"</span><span class="w">
         </span><span class="p">},</span><span class="w">
         </span><span class="nl">"devDependencies"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
             </span><span class="nl">"traceur"</span><span class="p">:</span><span class="w"> </span><span class="s2">"github:jmcriffey/bower-traceur@0.0.93"</span><span class="p">,</span><span class="w">
             </span><span class="nl">"traceur-runtime"</span><span class="p">:</span><span class="w"> </span><span class="s2">"github:jmcriffey/bower-traceur-runtime@0.0.93"</span><span class="w">
         </span><span class="p">}</span><span class="w">
     </span><span class="p">}</span><span class="w">
 </span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Simple. Right?</p>

<p>With that out of the way, I had just some boilerplate stuff left. Adding package details in package.json, name, author… that kind of stuff.</p>

<p>That is pretty much it. I pushed this off to github and was able to install it as a dependency the correct way in my work project.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jspm <span class="nb">install </span><span class="nv">stripe</span><span class="o">=</span>github:akagr/stripe-jspm
</code></pre></div></div>

<p>Here’s the finished thing: <a href="https://github.com/akagr/stripe-jspm">akagr/stripe-jspm</a></p>

<h2 id="on">On</h2>

<p>This package has some room for improvements. For example, we can probably remove <code class="language-plaintext highlighter-rouge">traceur</code> as a dev dependency since we’re not really using it in this package. And since it’s written in ES5 and earlier stuff, we’re not going to need it either.</p>

<p>This was my first time writing a package for jspm and I liked how I was able to do that and import it within a few minutes. Any suggestions for improvements to package or this post will be much appreciated. Feel free to shoot comments below or over at <a href="https://www.reddit.com/r/javascript/comments/41iuaq/how_to_write_a_jspm_package/">reddit</a>.</p>

  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="akagr/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/2016/01/18/how-to-write-a-jspm-package.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Lessons and ramblings. Thoughts and speculations. Opinions are my own.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/akagr" title="akagr"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/akshagrwl" title="akshagrwl"><svg class="svg-icon grey"><use xlink:href="/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
